<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.44">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Introduction – Supplementary material</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ex1_simulation.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html">Introduction</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Supplementary material</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Simpson’s paradox</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex1_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simulation example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">M-bias</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex2_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Simulation example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Post-treatment bias</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex3_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Simulation example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Case-control bias</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex4_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simulation example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Selection bias</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ex5_simulation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Simulation example</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#causal-diagrams" id="toc-causal-diagrams" class="nav-link active" data-scroll-target="#causal-diagrams">Causal diagrams</a>
  <ul class="collapse">
<li><a href="#confounder-and-descendant" id="toc-confounder-and-descendant" class="nav-link" data-scroll-target="#confounder-and-descendant">Confounder and descendant</a></li>
  <li><a href="#mediator-and-descendant" id="toc-mediator-and-descendant" class="nav-link" data-scroll-target="#mediator-and-descendant">Mediator and descendant</a></li>
  <li><a href="#collider-and-descendant" id="toc-collider-and-descendant" class="nav-link" data-scroll-target="#collider-and-descendant">Collider and descendant</a></li>
  </ul>
</li>
  <li><a href="#backdoor-criterion-and-adjustment-criterion" id="toc-backdoor-criterion-and-adjustment-criterion" class="nav-link" data-scroll-target="#backdoor-criterion-and-adjustment-criterion">Backdoor criterion and adjustment criterion</a></li>
  <li><a href="#causation-and-prediction" id="toc-causation-and-prediction" class="nav-link" data-scroll-target="#causation-and-prediction">Causation and prediction</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">Introduction</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="causal-diagrams" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="causal-diagrams">Causal diagrams</h2>
<p>To understand bias in causal research, it is important to recognize that biases are often spurious (non-causal) associations that arise from underlying causal structures. These structures can be formally represented as causal diagrams using Directed Acyclic Graphs (DAGs), which are visual models where variables are represented as nodes and causal relationships are depicted as arrows (edges) pointing from causes to their consequences. In a DAG, a causal path is a sequence of variables connected by directed edges (arrows) where all arrows point in the same direction, from the cause to the consequence. Conversely, a non-causal path contains at least one edge that points against the direction of the assumed causal flow. DAGs are acyclic, meaning they do not include feedback loops: no variable can causally influence itself, either directly or indirectly, within a single time point. DAGs are qualitative, nonparametric tools. They illustrate assumed causal relationships without specifying their strength or functional form. The arrows do not imply deterministic links, but rather the possibility of influence given appropriate conditions. Despite their simplicity, DAGs provide powerful insights into how statistical associations emerge—and how they can mislead us if misinterpreted. Biases can be characterized graphically based on the structural patterns in DAGs. There are four fundamental causal structures that serve as the basic building blocks for constructing more complex causal relationships in DAGs:</p>
<ul>
<li>Confounder (also called fork or common cause): A variable that causally affects (at least) two others.</li>
<li>Mediator (also called pipe or chain): A variable lying on the causal pathway from the cause to the consequence.</li>
<li>Collider (also called common effect): A variable that is causally influenced by (at least) two others.</li>
<li>Descendant: A variable that is causally influenced by another variable.</li>
</ul>
<div class="cell fig-cap-location-bottom" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1" data-cap-location="bottom"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag">ggdag</a></span><span class="op">)</span> <span class="co"># for DAG</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dagitty.net">dagitty</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># for visualisation</span></span>
<span></span>
<span><span class="va">dag_coords.intro</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'C'</span>, <span class="st">'I'</span>, <span class="st">'V'</span>, <span class="st">'S'</span>, <span class="st">'D'</span>, <span class="st">'P'</span><span class="op">)</span>,</span>
<span>             x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3.5</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">3.5</span><span class="op">)</span>,</span>
<span>             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DAG.intro</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">I</span> <span class="op">~</span> <span class="va">C</span>,</span>
<span>         <span class="va">C</span> <span class="op">~</span> <span class="va">V</span>,</span>
<span>         <span class="va">P</span> <span class="op">~</span> <span class="va">V</span>,</span>
<span>         <span class="va">S</span> <span class="op">~</span> <span class="va">C</span> <span class="op">+</span> <span class="va">V</span>,</span>
<span>         <span class="va">D</span> <span class="op">~</span> <span class="va">S</span>, </span>
<span>         coords <span class="op">=</span> <span class="va">dag_coords.intro</span><span class="op">)</span></span>
<span></span>
<span><span class="va">node_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  C <span class="op">=</span> <span class="st">'bold(C)'</span>,</span>
<span>  I <span class="op">=</span> <span class="st">'bold(I)'</span>,</span>
<span>  V <span class="op">=</span> <span class="st">'bold(V)'</span>,</span>
<span>  S <span class="op">=</span> <span class="st">'bold(S)'</span>,</span>
<span>  D <span class="op">=</span> <span class="st">'bold(D)'</span>,</span>
<span>  P <span class="op">=</span> <span class="st">'bold(P)'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="st">'mono'</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="st">'bold'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">3.3</span>, label <span class="op">=</span> <span class="st">'ventilation'</span>, </span>
<span>           size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2.3</span>, label <span class="op">=</span> <span class="st">'IAQ index'</span>, </span>
<span>           size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">2.3</span>, label <span class="op">=</span> <span class="st">'daily productivity'</span>, </span>
<span>           size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.6</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1.7</span>, label <span class="op">=</span> <span class="st">'power usage'</span>, </span>
<span>             size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.5</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">0.7</span>, label <span class="op">=</span> <span class="st">'CO2'</span>, </span>
<span>           size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.6</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html">annotate</a></span><span class="op">(</span><span class="st">'text'</span>, x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">0.7</span>, label <span class="op">=</span> <span class="st">'sleep quality'</span>, </span>
<span>           size <span class="op">=</span> <span class="fl">4</span>, hjust <span class="op">=</span> <span class="fl">0.6</span>, colour <span class="op">=</span> <span class="st">'grey50'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-DAG.intro" class="quarto-float quarto-figure quarto-figure-center anchored" data-cap-location="bottom" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-DAG.intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DAG.intro-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Fig.&nbsp;1. Example of a graphical representation of a causal structure via a Directed Acyclic Graph.
</figcaption></figure>
</div>
</div>
</div>
<p>For example, let us consider the hypothetical causal structure described in <a href="#fig-DAG.intro" class="quarto-xref">Fig.&nbsp;<span>1</span></a>. Here, CO<sub>2</sub> concentration <span class="math inline">\((\text{C})\)</span> affects sleep quality <span class="math inline">\((\text{S})\)</span>, while ventilation <span class="math inline">\((\text{V})\)</span> reduces CO<sub>2</sub> but also affects sleep quality <span class="math inline">\((\text{S})\)</span>, for example, by increasing noise. Moreover, high ventilation increases power usage <span class="math inline">\((\text{P})\)</span>, CO<sub>2</sub> concentration influences the Indoor Air Quality (IAQ) index <span class="math inline">\((\text{I})\)</span>, and low sleep quality leads to decreased daily productivity <span class="math inline">\((\text{D})\)</span>. In the context of this example, ventilation can act as a confounder (common cause) of CO<sub>2</sub> concentration and sleep quality (i.e., <span class="math inline">\(\text{C} \leftarrow \text{V} \rightarrow \text{S}\)</span>), while CO<sub>2</sub> concentration can be seen as a mediator between ventilation and sleep quality (i.e., <span class="math inline">\(\text{V} \rightarrow \text{C} \rightarrow \text{S}\)</span>). Sleep quality can serve as a collider (common effect) between ventilation and CO<sub>2</sub> concentration (i.e., <span class="math inline">\(\text{V} \rightarrow \text{S} \leftarrow \text{C}\)</span>), while power usage can function as a descendant of ventilation (i.e., <span class="math inline">\(\text{V} \rightarrow \text{P}\)</span>). To better understand the four fundamental causal structures, it is helpful to visualize them graphically. Importantly, these fundamental causal structures are not inherent properties of the variables—they depend entirely on the specific DAG and the causal question of interest.</p>
<section id="confounder-and-descendant" class="level3"><h3 class="anchored" data-anchor-id="confounder-and-descendant">Confounder and descendant</h3>
<div class="cell" data-layout-nrow="1" data-layout-align="center" data-fig-cap-location="bottom">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#example a: C -&gt; S is open</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common cause</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span> <span class="co">#'#C77CFF'</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example b: C -&gt; S is closed</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common cause</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 3.5, y = 3, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">3</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example c: C -&gt; S is partially closed</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common cause</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 3.5, y = 2, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-DAG.intro.C_S" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-DAG.intro.C_S-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.C_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.C_S-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.C_S-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.C_S-1.png" id="fig-DAG.intro.C_S-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.C_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.C_S-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.C_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.C_S-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.C_S-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.C_S-2.png" id="fig-DAG.intro.C_S-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.C_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.C_S-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.C_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.C_S-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.C_S-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.C_S-3.png" id="fig-DAG.intro.C_S-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.C_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.C_S-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DAG.intro.C_S-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Fig.&nbsp;2. Illustrations of confounder and descendant. Green lines indicate the causal questions of interest; orange lines indicate open paths; light blue lines indicate closed paths; dashed orange and light blue lines indicate partially open and closed paths, respectively; a grey-filled box indicates statistical adjustment.
</figcaption></figure>
</div>
</div>
<p>In <a href="#fig-DAG.intro.C_S" class="quarto-xref">Fig.&nbsp;<span>2</span></a>, we are interested in the total average causal effect (green line) of CO<sub>2</sub> concentration <span class="math inline">\((\text{C})\)</span> on sleep quality <span class="math inline">\((\text{S})\)</span>. In this setting, ventilation <span class="math inline">\((\text{V})\)</span> is a confounder (i.e., common cause) of <span class="math inline">\(\text{C}\)</span> and <span class="math inline">\(\text{S}\)</span> and creates a non-causal path between <span class="math inline">\(\text{C}\)</span> and <span class="math inline">\(\text{S}\)</span> (i.e., <span class="math inline">\(\text{C} \leftarrow \text{V} \rightarrow \text{S}\)</span>). Leaving a confounder unadjusted keeps the non-causal path open (orange line in <a href="#fig-DAG.intro.C_S" class="quarto-xref">Fig.&nbsp;<span>2</span></a> (a)), introducing bias. Adjusting for a confounder (e.g., via including it as a predictor in a regression model) blocks this path. <a href="#fig-DAG.intro.C_S" class="quarto-xref">Fig.&nbsp;<span>2</span></a> (b) illustrates this, where the grey-filled box visually represents the adjustment, and the light blue line indicates the blocked path. Adjusting for the descendant of a confounder is illustrated in <a href="#fig-DAG.intro.C_S" class="quarto-xref">Fig.&nbsp;<span>2</span></a> (c). Generally, adjusting for a descendant has a similar effect as adjusting for its direct parent variable, but the impact depends on how well the descendant captures the parent’s influence. The effect will not be identical unless the descendant fully represents the parent (i.e., if the descendant is a perfect proxy for the parent). Assuming that power usage <span class="math inline">\((\text{P})\)</span> is not a perfect proxy for ventilation <span class="math inline">\((\text{V})\)</span>, adjusting for <span class="math inline">\(\text{P}\)</span> (grey-filled box) will only partially close the path (dashed light blue line). As a result, bias will occur, but its absolute magnitude will be less than that with a fully open path.</p>
</section><section id="mediator-and-descendant" class="level3"><h3 class="anchored" data-anchor-id="mediator-and-descendant">Mediator and descendant</h3>
<div class="cell" data-layout-nrow="1" data-layout-align="center" data-fig-cap-location="bottom">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#example a: V -&gt; S is open</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#mediation path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example b: V -&gt; S is closed</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#mediation path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 1, y = 1, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example c: V -&gt; S is partially closed</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#mediation path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 1, y = 2, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-DAG.intro.V_S" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-DAG.intro.V_S-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_S-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_S-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_S-1.png" id="fig-DAG.intro.V_S-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_S-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_S-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_S-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_S-2.png" id="fig-DAG.intro.V_S-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_S-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_S" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_S-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_S-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_S-3.png" id="fig-DAG.intro.V_S-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_S" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_S-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DAG.intro.V_S-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Fig.&nbsp;3. Illustrations of mediator and descendant. Green lines indicate the causal questions of interest; orange lines indicate open paths; light blue lines indicate closed paths; dashed orange and light blue lines indicate partially open and closed paths, respectively; a grey-filled box indicates statistical adjustment.
</figcaption></figure>
</div>
</div>
<p>In <a href="#fig-DAG.intro.V_S" class="quarto-xref">Fig.&nbsp;<span>3</span></a>, we are interested in the direct average causal effect (green line) of ventilation <span class="math inline">\((\text{V})\)</span> on sleep quality <span class="math inline">\((\text{S})\)</span>. In this setting, CO<sub>2</sub> concentration <span class="math inline">\((\text{C})\)</span> is a mediator of <span class="math inline">\(\text{V}\)</span> and <span class="math inline">\(\text{S}\)</span> (i.e., <span class="math inline">\(\text{V} \rightarrow \text{C} \rightarrow \text{S}\)</span>). The path <span class="math inline">\(\text{V} \rightarrow \text{C} \rightarrow \text{S}\)</span> is a causal path, specifically the indirect causal effect of <span class="math inline">\(\text{V}\)</span> on <span class="math inline">\(\text{S}\)</span>. However, it is not the causal effect of interest, since we are interested in the direct causal effect of <span class="math inline">\(\text{V}\)</span> on <span class="math inline">\(\text{S}\)</span>. Leaving the mediator unadjusted keeps that causal path open (orange line in <a href="#fig-DAG.intro.V_S" class="quarto-xref">Fig.&nbsp;<span>3</span></a> (a)). Adjusting for a mediator blocks the causal pathway on which it lies. <a href="#fig-DAG.intro.V_S" class="quarto-xref">Fig.&nbsp;<span>3</span></a> (b) illustrates this, where the grey-filled box visually represents the adjustment, and the light blue line indicates the blocked path. Adjusting for the descendant of a mediator is illustrated in <a href="#fig-DAG.intro.V_S" class="quarto-xref">Fig.&nbsp;<span>3</span></a> (c). Assuming IAQ index <span class="math inline">\((\text{I})\)</span> is not a perfect proxy of CO<sub>2</sub> concentration <span class="math inline">\((\text{C})\)</span>, adjusting for <span class="math inline">\(\text{I}\)</span> (grey-filled box) will only partially close the path (dashed light blue line).</p>
</section><section id="collider-and-descendant" class="level3"><h3 class="anchored" data-anchor-id="collider-and-descendant">Collider and descendant</h3>
<div class="cell" data-layout-nrow="1" data-layout-align="center" data-fig-cap-location="bottom">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#example a: V -&gt; C is closed</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common effect</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#0072B2'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example b: V -&gt; C is open</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common effect</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 6, y = 1, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#example c: V -&gt; C is partially open</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#backdoor path: common effect</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">3.5</span>, xend <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">3</span>, yend <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">8</span>, lineend <span class="op">=</span> <span class="st">'square'</span>, colour <span class="op">=</span> <span class="st">'#D55E00'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, linetype <span class="op">=</span> <span class="st">'12'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#adjusted variable</span></span>
<span><span class="co">#  geom_point(x = 6, y = 2, shape = 0, size = 12, stroke = 0.9, color = 'black') +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">6</span>, y <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">22</span>, size <span class="op">=</span> <span class="fl">14</span>, stroke <span class="op">=</span> <span class="fl">0.9</span>, fill <span class="op">=</span> <span class="st">'grey80'</span>, colour <span class="op">=</span> <span class="st">'black'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#visualise causal effect path</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span>, xend <span class="op">=</span> <span class="fl">3.5</span>, y <span class="op">=</span> <span class="fl">1</span>, yend <span class="op">=</span> <span class="fl">3</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">14</span>, lineend <span class="op">=</span> <span class="st">'round'</span>, colour <span class="op">=</span> <span class="st">'#009E73'</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>, size <span class="op">=</span> <span class="fl">10</span>, parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'mono'</span><span class="op">)</span>, </span>
<span>                 fontface <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'bold'</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">3.2</span><span class="op">)</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="fig-DAG.intro.V_C" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-DAG.intro.V_C-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_C" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_C-1" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_C-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_C-1.png" id="fig-DAG.intro.V_C-1" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_C" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_C-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_C" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_C-2" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_C-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_C-2.png" id="fig-DAG.intro.V_C-2" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_C" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_C-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-DAG.intro.V_C" style="flex-basis: 33.3%;justify-content: center;">
<div id="fig-DAG.intro.V_C-3" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center" width="4050">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-DAG.intro.V_C-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.intro.V_C-3.png" id="fig-DAG.intro.V_C-3" class="img-fluid quarto-figure quarto-figure-center anchored figure-img" data-ref-parent="fig-DAG.intro.V_C" width="4050">
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-DAG.intro.V_C-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca"></figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DAG.intro.V_C-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Fig.&nbsp;4. Illustrations of collider and descendant. Green lines indicate the causal questions of interest; orange lines indicate open paths; light blue lines indicate closed paths; dashed orange and light blue lines indicate partially open and closed paths, respectively; a grey-filled box indicates statistical adjustment.
</figcaption></figure>
</div>
</div>
<p>In <a href="#fig-DAG.intro.V_C" class="quarto-xref">Fig.&nbsp;<span>4</span></a>, we are interested in the total average causal effect (green line) of ventilation <span class="math inline">\((\text{V})\)</span> on CO<sub>2</sub> concentration <span class="math inline">\((\text{C})\)</span>. In this setting, sleep quality <span class="math inline">\((\text{S})\)</span> is a collider (i.e., common effect) of <span class="math inline">\(\text{V}\)</span> and <span class="math inline">\(\text{C}\)</span> and creates a non-causal path between <span class="math inline">\(\text{V}\)</span> and <span class="math inline">\(\text{C}\)</span> (i.e., <span class="math inline">\(\text{V} \rightarrow \text{S} \leftarrow \text{C}\)</span>). Leaving a collider unadjusted keeps the non-causal path closed (light blue line in <a href="#fig-DAG.intro.V_C" class="quarto-xref">Fig.&nbsp;<span>4</span></a> (a)). Adjusting for a collider opens this path, introducing bias. <a href="#fig-DAG.intro.V_C" class="quarto-xref">Fig.&nbsp;<span>4</span></a> (b) illustrates this, where the grey-filled box visually represents the adjustment, and the orange line indicates the opened path. Adjusting for the descendant of a collider is illustrated in <a href="#fig-DAG.intro.V_C" class="quarto-xref">Fig.&nbsp;<span>4</span></a> (c). Assuming that daily productivity <span class="math inline">\((\text{D})\)</span> is not a perfect proxy of sleep quality <span class="math inline">\((\text{S})\)</span>, adjusting for <span class="math inline">\(\text{D}\)</span> (grey-filled box) will only partially open the path (dashed orange line). As a result, bias will occur, but its absolute magnitude will be less than that with a fully open path.</p>
</section></section><section id="backdoor-criterion-and-adjustment-criterion" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="backdoor-criterion-and-adjustment-criterion">Backdoor criterion and adjustment criterion</h2>
<p>A central question in causal inference is whether it is possible to isolate and identify the true causal effect. For this purpose, a simple yet powerful graphical tool exists: the backdoor criterion. While it may sound technical, its logic is intuitive and has become increasingly relevant in human-centric building science research.</p>
<p>The backdoor criterion is a test that can be applied directly to the DAG to determine whether a set(s) of variables exists that is sufficient to identify the total average causal effect of interest. This rule can be applied purely visually using DAGs without requiring any statistical equations. Two conditions must be met to satisfy the backdoor criterion, specifically:</p>
<ol type="1">
<li>The adjustment set (i.e., the group of variables that must be adjusted for to accurately estimate the causal effect of interest) must not include any descendant of the cause of interest;</li>
<li>The adjustment set must block every path between the cause and its consequence that starts with an arrow pointing into the cause. These paths are called backdoor paths.</li>
</ol>
<p>The core idea of the backdoor criterion for identifying the total average causal effect of a treatment on the outcome is to block all backdoor paths between them, without adjusting for any descendant of the treatment. When these two conditions are satisfied, the total average causal effect is identifiable, that is, it is in principle estimable from the data. If these conditions are not met, under the given causal assumptions, the causal effect may not be identifiable. There are cases where a valid adjustment set exists (i.e., one can identify the causal effect by adjusting), but the backdoor criterion cannot find it. To address this issue, Shpitser et al.&nbsp;introduced the adjustment criterion, which generalized the backdoor criterion. Specifically, if a valid adjustment set exists, the adjustment criterion will identify at least one such set.</p>
<p>The adjustment criterion is also based on two conditions. Assuming that <span class="math inline">\(\text{X}\)</span> is the cause and <span class="math inline">\(\text{Y}\)</span> is the outcome of interest, the conditions are:</p>
<ol type="1">
<li>The adjustment set must exclude any descendant of <span class="math inline">\(\text{X}\)</span> that lies on a causal path from <span class="math inline">\(\text{X}\)</span> to <span class="math inline">\(\text{Y}\)</span>;</li>
<li>The adjustment set must block all non-causal paths from <span class="math inline">\(\text{X}\)</span> to <span class="math inline">\(\text{Y}\)</span>.</li>
</ol>
<p>These conditions differ from those of the backdoor criterion. The first condition permits the inclusion of descendants of <span class="math inline">\(\text{X}\)</span>, provided they are not on the causal path from <span class="math inline">\(\text{X}\)</span> to <span class="math inline">\(\text{Y}\)</span>. The second condition requires closing all non-causal paths, not just the backdoor paths (since backdoor paths are non-causal paths, but not all non-causal paths are backdoor paths). If either of these conditions is violated, under the given causal assumptions, no valid adjustment set exists.</p>
</section><section id="causation-and-prediction" class="level2"><h2 class="anchored" data-anchor-id="causation-and-prediction">Causation and prediction</h2>
<div class="cell fig-cap-location-bottom" data-layout-align="center">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5" data-cap-location="bottom"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-causal/ggdag">ggdag</a></span><span class="op">)</span> <span class="co"># for DAG</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dagitty.net">dagitty</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span> <span class="co"># for visualisation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggforce.data-imaginist.com">ggforce</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">dag_coords.intro</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'X5'</span>, <span class="st">'X1'</span>, <span class="st">'X3'</span>, <span class="st">'X7'</span>, <span class="st">'Y'</span>, <span class="st">'X2'</span>, <span class="st">'X4'</span>, <span class="st">'X8'</span>, <span class="st">'X6'</span><span class="op">)</span>,</span>
<span>             x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">6</span>, <span class="fl">8.5</span>, <span class="fl">8.5</span>, <span class="fl">8.5</span>, <span class="fl">11</span><span class="op">)</span>,</span>
<span>             y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DAG.intro</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/dagify.html">dagify</a></span><span class="op">(</span><span class="va">X3</span> <span class="op">~</span> <span class="va">X1</span>,</span>
<span>         <span class="va">X4</span> <span class="op">~</span> <span class="va">X2</span>,</span>
<span>         <span class="va">Y</span> <span class="op">~</span> <span class="va">X3</span> <span class="op">+</span> <span class="va">X4</span>,</span>
<span>         <span class="va">X7</span> <span class="op">~</span> <span class="va">Y</span> <span class="op">+</span> <span class="va">X5</span>,</span>
<span>         <span class="va">X8</span> <span class="op">~</span> <span class="va">Y</span> <span class="op">+</span> <span class="va">X6</span>,</span>
<span>         <span class="va">X9</span> <span class="op">~</span> <span class="va">X7</span>, </span>
<span>         coords <span class="op">=</span> <span class="va">dag_coords.intro</span><span class="op">)</span></span>
<span></span>
<span><span class="va">node_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  X1 <span class="op">=</span> <span class="st">'bold(X[1])'</span>, </span>
<span>  X2 <span class="op">=</span> <span class="st">'bold(X[2])'</span>, </span>
<span>  X3 <span class="op">=</span> <span class="st">'bold(X[3])'</span>, </span>
<span>  X4 <span class="op">=</span> <span class="st">'bold(X[4])'</span>, </span>
<span>  X5 <span class="op">=</span> <span class="st">'bold(X[5])'</span>,</span>
<span>  X6 <span class="op">=</span> <span class="st">'bold(X[6])'</span>, </span>
<span>  X7 <span class="op">=</span> <span class="st">'bold(X[7])'</span>, </span>
<span>  X8 <span class="op">=</span> <span class="st">'bold(X[8])'</span>, </span>
<span>  Y <span class="op">=</span> <span class="st">'bold(Y)'</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">highlight.nodes_cause</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'Y'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">highlight.nodes_prediction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'X3'</span>, <span class="st">'X4'</span>, <span class="st">'Y'</span>, <span class="st">'X5'</span>, <span class="st">'X7'</span>, <span class="st">'X8'</span>, <span class="st">'X6'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">highlight.nodes_collider1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Y'</span>, <span class="st">'X5'</span>, <span class="st">'X7'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">highlight.nodes_collider2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Y'</span>,  <span class="st">'X8'</span>, <span class="st">'X6'</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">DAG.intro</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, xend <span class="op">=</span> <span class="va">xend</span>, yend <span class="op">=</span> <span class="va">yend</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span> <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dag_coords.intro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">highlight.nodes_cause</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="op">{</span> <span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">.</span>, </span>
<span>               x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>    <span class="co">#subset(dag_coords.intro, name %in% highlight.nodes_cause),</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'#CC79A7'</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dag_coords.intro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">highlight.nodes_prediction</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="op">{</span> <span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">.</span>, </span>
<span>               x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>    <span class="co">#subset(dag_coords.intro, name %in% highlight.nodes_prediction),</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'#0072B2'</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dag_coords.intro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">highlight.nodes_collider1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="op">{</span> <span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">.</span>, </span>
<span>               x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>    <span class="co">#subset(dag_coords.intro, name %in% highlight.nodes_collider1),</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'#E69F00'</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">dag_coords.intro</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">highlight.nodes_collider2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>      <span class="op">{</span> <span class="va">centroid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="va">.</span>, </span>
<span>               x <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>               y <span class="op">=</span> <span class="va">y</span> <span class="op">+</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="op">(</span><span class="va">y</span> <span class="op">-</span> <span class="va">centroid</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span>,</span>
<span>    <span class="co">#subset(dag_coords.intro, name %in% highlight.nodes_collider2),</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, inherit.aes <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>    colour <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/alpha.html">alpha</a></span><span class="op">(</span><span class="st">'#E69F00'</span>, <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>    size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_text.html">geom_dag_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">node_labels</span><span class="op">[</span><span class="va">name</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                parse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                family <span class="op">=</span> <span class="st">'mono'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/geom_dag_edges.html">geom_dag_edges</a></span><span class="op">(</span>arrow_directed <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/arrow.html">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fl">10</span>, <span class="st">'pt'</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">'open'</span><span class="op">)</span>,</span>
<span>                 edge_colour <span class="op">=</span> <span class="st">'black'</span>,</span>
<span>                 family <span class="op">=</span> <span class="st">'mono'</span>,</span>
<span>                 fontface <span class="op">=</span> <span class="st">'bold'</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html">coord_cartesian</a></span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">11.5</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">4.2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://r-causal.github.io/ggdag/reference/theme_dag_blank.html">theme_dag</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-DAG.general" class="quarto-float quarto-figure quarto-figure-center anchored" data-cap-location="bottom" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-DAG.general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="intro_files/figure-html/fig-DAG.general-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-DAG.general-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Fig.&nbsp;5. Illustrations of causation and prediction for an outcome <span class="math inline">\(\text{Y}\)</span>. The pink outline indicates the direct causes of <span class="math inline">\(\text{Y}\)</span>; the blue outline indicates the Markov blanket for <span class="math inline">\(\text{Y}\)</span>; the orange outlines indicate the colliders.
</figcaption></figure>
</div>
</div>
</div>
<p>As previously mentioned, in a Directed Acyclic Graph (DAG), causation follows the the direction of the arrow but association does not. In <a href="#fig-DAG.general" class="quarto-xref">Fig.&nbsp;<span>5</span></a>, for example, <span class="math inline">\(\text{X}_1\)</span> and <span class="math inline">\(\text{X}_3\)</span> are associated because there is a line connecting them, but since the arrow goes from <span class="math inline">\(\text{X}_1\)</span> to <span class="math inline">\(\text{X}_3\)</span> (i.e., <span class="math inline">\(\text{X}_1 \rightarrow \text{X}_3\)</span>), the DAG assumes that <span class="math inline">\(\text{X}_1\)</span> is causing <span class="math inline">\(\text{X}_3\)</span>: changing <span class="math inline">\(\text{X}_1\)</span> will change <span class="math inline">\(\text{X}_3\)</span>, but changing <span class="math inline">\(\text{X}_3\)</span> will not affect <span class="math inline">\(\text{X}_1\)</span>. This directionality is critical for causal inference, which seeks to answer “what-if” questions about the effect of actively intervening on a variable. Pure prediction, in contrast, relies on observed associations. To predict <span class="math inline">\(\text{X}_1\)</span>, one could use <span class="math inline">\(\text{X}_3\)</span>, even though <span class="math inline">\(\text{X}_3\)</span> is the consequence of <span class="math inline">\(\text{X}_1\)</span>. If the association between <span class="math inline">\(\text{X}_1\)</span> and <span class="math inline">\(\text{X}_3\)</span> is positive, observing a high value for <span class="math inline">\(\text{X}_3\)</span> would imply observing a high value for <span class="math inline">\(\text{X}_1\)</span>. The important point is that this implies observing <span class="math inline">\(\text{X}_1\)</span> and <span class="math inline">\(\text{X}_3\)</span> rather than directly changing them. Manually setting <span class="math inline">\(\text{X}_3\)</span> to a high value will not affect <span class="math inline">\(\text{X}_1\)</span>.</p>
<p>To better illustrate the difference between causation and prediction, consider that in <a href="#fig-DAG.general" class="quarto-xref">Fig.&nbsp;<span>5</span></a> the outcome of interest is <span class="math inline">\(\text{Y}\)</span>. Here, <span class="math inline">\(\text{Y}\)</span> is directly causes by <span class="math inline">\(\text{X}_3\)</span> and <span class="math inline">\(\text{X}_4\)</span> and indirectly by <span class="math inline">\(\text{X}_1\)</span> (i.e., <span class="math inline">\(\text{X}_1 \rightarrow \text{X}_3 \rightarrow \text{Y}\)</span>) and <span class="math inline">\(\text{X}_2\)</span> (i.e., <span class="math inline">\(\text{X}_2 \rightarrow \text{X}_4 \rightarrow \text{Y}\)</span>). As such, all causal information for <span class="math inline">\(\text{Y}\)</span> is contained in <span class="math inline">\(\text{X}_3\)</span> and <span class="math inline">\(\text{X}_4\)</span> (the pink outline in <a href="#fig-DAG.general" class="quarto-xref">Fig.&nbsp;<span>5</span></a>). However, if the goal is to predict <span class="math inline">\(\text{Y}\)</span>, a more accurate prediction can be obtained by including also <span class="math inline">\(\text{X}_5\)</span>, <span class="math inline">\(\text{X}_6\)</span>, <span class="math inline">\(\text{X}_7\)</span> and <span class="math inline">\(\text{X}_8\)</span> (the blue outline in <a href="#fig-DAG.general" class="quarto-xref">Fig.&nbsp;<span>5</span></a>). This is the case because, by blocking all paths leading to <span class="math inline">\(\text{Y}\)</span>, these variables (i.e., <span class="math inline">\(\text{X}_3\)</span>, <span class="math inline">\(\text{X}_4\)</span>, <span class="math inline">\(\text{X}_5\)</span>, <span class="math inline">\(\text{X}_6\)</span>, <span class="math inline">\(\text{X}_7\)</span> and <span class="math inline">\(\text{X}_8\)</span>) encompass all the information available in the data about <span class="math inline">\(\text{Y}\)</span>. The set of variables that contains all information about <span class="math inline">\(\text{Y}\)</span> (or more formally, the set of variables that renders <span class="math inline">\(\text{Y}\)</span> conditionally independent of all other variables in the DAG) is called the Markov blanket.</p>
<p>A predictive model can leverage all the information contained in the Markov blanket to improve accuracy, even though some of the variables are not causal (i.e., <span class="math inline">\(\text{X}_5\)</span>, <span class="math inline">\(\text{X}_6\)</span>, <span class="math inline">\(\text{X}_7\)</span> and <span class="math inline">\(\text{X}_8\)</span>). A causal model should only include variables that are needed to identify the causal effect of interest. As explained previously, <span class="math inline">\(\text{X}_5 \rightarrow \text{X}_7 \leftarrow \text{Y}\)</span> and <span class="math inline">\(\text{Y} \rightarrow \text{X}_8 \leftarrow \text{X}_6\)</span> are colliders (the orange outline in <a href="#fig-DAG.general" class="quarto-xref">Fig.&nbsp;<span>5</span></a>). Therefore, including <span class="math inline">\(\text{X}_5\)</span>, <span class="math inline">\(\text{X}_6\)</span>, <span class="math inline">\(\text{X}_7\)</span> and <span class="math inline">\(\text{X}_8\)</span> will introduce bias.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-bayesboot2025" class="csl-entry" role="listitem">
Bååth, R., 2025. Bayesboot: An implementation of rubin’s (1981) bayesian bootstrap. <a href="https://doi.org/10.32614/CRAN.package.bayesboot">https://doi.org/10.32614/CRAN.package.bayesboot</a>
</div>
<div id="ref-ggdag2025" class="csl-entry" role="listitem">
Barrett, M., 2024. <a href="https://CRAN.R-project.org/package=ggdag">Ggdag: Analyze and create elegant directed acyclic graphs</a>.
</div>
<div id="ref-car2025" class="csl-entry" role="listitem">
Fox, J., Weisberg, S., 2019. <a href="https://www.john-fox.ca/Companion/">An <span>R</span> companion to applied regression</a>, Third. ed. Sage, Thousand Oaks <span>CA</span>.
</div>
<div id="ref-rstanarm2025" class="csl-entry" role="listitem">
Goodrich, B., Gabry, J., Ali, I., Brilleman, S., 2024. <a href="https://mc-stan.org/rstanarm/">Rstanarm: <span>Bayesian</span> applied regression modeling via <span>Stan</span>.</a>
</div>
<div id="ref-gt2025" class="csl-entry" role="listitem">
Iannone, R., Cheng, J., Schloerke, B., Hughes, E., Lauer, A., Seo, J., Brevoort, K., Roy, O., 2025. <a href="https://CRAN.R-project.org/package=gt">Gt: Easily create presentation-ready display tables</a>.
</div>
<div id="ref-ggdist2025b" class="csl-entry" role="listitem">
Kay, M., 2025. <span class="nocase">ggdist</span>: Visualizations of distributions and uncertainty. <a href="https://doi.org/10.5281/zenodo.3879620">https://doi.org/10.5281/zenodo.3879620</a>
</div>
<div id="ref-tidybayes2025" class="csl-entry" role="listitem">
Kay, M., 2024b. <span class="nocase">tidybayes</span>: Tidy data and geoms for <span>Bayesian</span> models. <a href="https://doi.org/10.5281/zenodo.1308151">https://doi.org/10.5281/zenodo.1308151</a>
</div>
<div id="ref-ggdist2025a" class="csl-entry" role="listitem">
Kay, M., 2024a. <span class="nocase">ggdist</span>: Visualizations of distributions and uncertainty in the grammar of graphics. IEEE Transactions on Visualization and Computer Graphics 30, 414–424. <a href="https://doi.org/10.1109/TVCG.2023.3327195">https://doi.org/10.1109/TVCG.2023.3327195</a>
</div>
<div id="ref-Rstudio2025" class="csl-entry" role="listitem">
Posit team, 2025. <a href="http://www.posit.co/">RStudio: Integrated development environment for r</a>. Posit Software, PBC, Boston, MA.
</div>
<div id="ref-R2025" class="csl-entry" role="listitem">
R Core Team, 2023. <a href="https://www.R-project.org/">R: A language and environment for statistical computing</a>. R Foundation for Statistical Computing, Vienna, Austria.
</div>
<div id="ref-rstan2025" class="csl-entry" role="listitem">
Stan Development Team, 2025. <a href="https://mc-stan.org/"><span>RStan</span>: The <span>R</span> interface to <span>Stan</span></a>.
</div>
<div id="ref-dagitty2025" class="csl-entry" role="listitem">
Textor, J., van der Zander, B., Gilthorpe, M.S., Liśkiewicz, M., Ellison, G.T., 2016. Robust causal inference using directed acyclic graphs: The <span>R</span> package ’dagitty’. International Journal of Epidemiology 45, 1887–1894. <a href="https://doi.org/10.1093/ije/dyw341">https://doi.org/10.1093/ije/dyw341</a>
</div>
<div id="ref-tidyverse2025" class="csl-entry" role="listitem">
Wickham, H., Averick, M., Bryan, J., Chang, W., McGowan, L.D., François, R., Grolemund, G., Hayes, A., Henry, L., Hester, J., Kuhn, M., Pedersen, T.L., Miller, E., Bache, S.M., Müller, K., Ooms, J., Robinson, D., Seidel, D.P., Spinu, V., Takahashi, K., Vaughan, D., Wilke, C., Woo, K., Yutani, H., 2019. Welcome to the <span class="nocase">tidyverse</span>. Journal of Open Source Software 4, 1686. <a href="https://doi.org/10.21105/joss.01686">https://doi.org/10.21105/joss.01686</a>
</div>
</div>
</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ex1_simulation.html" class="pagination-link" aria-label="Simulation example">
        <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Simulation example</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>This notebook was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>© 2024. <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></p>
</div>
  </div>
</footer>


</body></html>